<!DOCTYPE html>

<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Jose Barbearia</title>

<style>
* {
margin: 0;
padding: 0;
box-sizing: border-box;
font-family: Arial, sans-serif;
}

body {
background: #0e0e0e;
color: #fff;
display: flex;
justify-content: center;
align-items: center;
min-height: 100vh;
}

.container {
width: 95%;
max-width: 420px;
background: #1c1c1c;
padding: 25px;
border-radius: 12px;
box-shadow: 0 0 20px rgba(0,0,0,0.6);
}

h1 {
text-align: center;
margin-bottom: 20px;
font-size: 26px;
}

label {
font-size: 14px;
margin-top: 12px;
display: block;
}

input, select {
width: 100%;
padding: 12px;
margin-top: 6px;
border-radius: 6px;
border: none;
background: #2a2a2a;
color: #fff;
font-size: 16px;
}

button {
width: 100%;
padding: 14px;
margin-top: 18px;
border: none;
border-radius: 6px;
background: #00c853;
color: #fff;
font-size: 17px;
font-weight: bold;
cursor: pointer;
}

button:hover {
background: #00a844;
}

.info {
text-align: center;
margin-top: 12px;
font-size: 13px;
color: #aaa;
}
</style>

<!-- Firebase -->

<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>

<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

<script>
// ===== CONFIGURE SEU FIREBASE =====
const firebaseConfig = {
apiKey: "SUA_API_KEY",
authDomain: "SEU_PROJETO.firebaseapp.com",
databaseURL: "https://SEU_PROJETO-default-rtdb.firebaseio.com/",
projectId: "SEU_PROJETO",
storageBucket: "SEU_PROJETO.appspot.com",
messagingSenderId: "000000000",
appId: "APP_ID"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();
</script>

</head>
<body>

<div class="container">
<h1>Jose Barbearia</h1>

<label>Nome</label> <input type="text" id="nome" placeholder="Digite seu nome">

<label>Serviço</label> <select id="servico">

<option value="">Selecione</option>
<option value="Corte - 30">Corte - R$30</option>
<option value="Barba - 20">Barba - R$20</option>
<option value="Corte + Barba - 45">Corte + Barba - R$45</option>
</select>

<label>Data</label> <input type="date" id="data">

<label>Horário</label> <select id="hora">

<option>Selecione a data</option>
</select>

<button onclick="agendar()">Agendar</button>

<div class="info">Horários ocupados não aparecem</div>
</div>

<script>
const horasPadrao = [
"08:00","09:00","10:00","11:00",
"13:00","14:00","15:00","16:00","17:00","18:00"
];

const dataInput = document.getElementById("data");
const horaSelect = document.getElementById("hora");

dataInput.addEventListener("change", carregarHorarios);

function carregarHorarios() {
const data = dataInput.value;
horaSelect.innerHTML = "<option>Carregando...</option>";

db.ref("agendamentos").once("value", snapshot => {

let ocupados = [];

snapshot.forEach(item => {
const ag = item.val();
if(ag.data === data){
ocupados.push(ag.hora);
}
});

horaSelect.innerHTML = "";

horasPadrao.forEach(h => {
if(!ocupados.includes(h)){
let op = document.createElement("option");
op.value = h;
op.text = h;
horaSelect.appendChild(op);
}
});

if(horaSelect.innerHTML === ""){
horaSelect.innerHTML = "<option>Sem horários disponíveis</option>";
}

});
}

function agendar() {
const nome = document.getElementById("nome").value.trim();
const servico = document.getElementById("servico").value;
const data = dataInput.value;
const hora = horaSelect.value;

if(!nome || !servico || !data || !hora || hora.includes("Sem")){
alert("Preencha todos os campos");
return;
}

const id = data + "_" + hora;

db.ref("agendamentos/" + id).once("value", snap => {

if(snap.exists()){
alert("Horário já ocupado");
carregarHorarios();
return;
}

db.ref("agendamentos/" + id).set({
nome,
servico,
data,
hora,
criadoEm: Date.now()
});

alert("Agendamento confirmado!");

const numero = "5516997369740";
const msg = `Olá, agendei ${servico} para o dia ${data} às ${hora}. Nome: ${nome}`;

window.open(`https://wa.me/${numero}?text=${encodeURIComponent(msg)}`);

document.getElementById("nome").value = "";

});
}
</script>

</body>
</html>
