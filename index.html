<!DOCTYPE html>

<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Jose Barbearia</title>

<!-- Google Font -->

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<style>
* {
margin: 0;
padding: 0;
box-sizing: border-box;
font-family: 'Poppins', sans-serif;
}

body {
background: linear-gradient(180deg, #0d0d0d, #000);
color: #fff;
display: flex;
justify-content: center;
align-items: center;
min-height: 100vh;
}

.card {
width: 92%;
max-width: 420px;
background: #1a1a1a;
border-radius: 18px;
padding: 28px;
box-shadow: 0 10px 30px rgba(0,0,0,0.7);
}

h1 {
text-align: center;
font-size: 26px;
margin-bottom: 25px;
font-weight: 600;
}

label {
display: block;
margin-top: 14px;
font-size: 14px;
color: #ccc;
}

input, select {
width: 100%;
margin-top: 6px;
padding: 14px;
border-radius: 10px;
border: none;
background: #2b2b2b;
color: #fff;
font-size: 15px;
}

input::placeholder {
color: #888;
}

button {
width: 100%;
margin-top: 22px;
padding: 16px;
border: none;
border-radius: 10px;
background: #0bbf4f;
color: #fff;
font-size: 18px;
font-weight: 600;
cursor: pointer;
transition: 0.2s;
}

button:hover {
background: #09a944;
}

.footer {
text-align: center;
margin-top: 14px;
font-size: 13px;
color: #888;
}
</style>

<!-- Firebase -->

<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>

<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

<script>
const firebaseConfig = {
apiKey: "SUA_API_KEY",
authDomain: "SEU_PROJETO.firebaseapp.com",
databaseURL: "https://SEU_PROJETO-default-rtdb.firebaseio.com/",
projectId: "SEU_PROJETO",
storageBucket: "SEU_PROJETO.appspot.com",
messagingSenderId: "000000000",
appId: "APP_ID"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();
</script>

</head>
<body>

<div class="card">

<h1>Jose Barbearia</h1>

<label>Nome</label> <input type="text" id="nome" placeholder="Digite seu nome">

<label>Serviço</label> <select id="servico">

<option value="">Selecione</option>
<option value="Corte - 30">Corte - R$30</option>
<option value="Barba - 20">Barba - R$20</option>
<option value="Corte + Barba - 45">Corte + Barba - R$45</option>
</select>

<label>Data</label> <input type="date" id="data">

<label>Horário</label> <select id="hora">

<option>Selecione a data</option>
</select>

<button onclick="agendar()">Agendar</button>

<div class="footer">Horários ocupados não aparecem</div>

</div>

<script>
const horas = [
"08:00","09:00","10:00","11:00",
"13:00","14:00","15:00","16:00","17:00","18:00"
];

const dataInput = document.getElementById("data");
const horaSelect = document.getElementById("hora");

dataInput.addEventListener("change", () => {
const data = dataInput.value;
horaSelect.innerHTML = "<option>Carregando...</option>";

db.ref("agendamentos").once("value", snap => {

let ocupados = [];

snap.forEach(item => {
const ag = item.val();
if(ag.data === data){
ocupados.push(ag.hora);
}
});

horaSelect.innerHTML = "";

horas.forEach(h => {
if(!ocupados.includes(h)){
let op = document.createElement("option");
op.value = h;
op.text = h;
horaSelect.appendChild(op);
}
});

if(horaSelect.innerHTML === ""){
horaSelect.innerHTML = "<option>Sem horários disponíveis</option>";
}

});
});

function agendar(){
const nome = document.getElementById("nome").value.trim();
const servico = document.getElementById("servico").value;
const data = dataInput.value;
const hora = horaSelect.value;

if(!nome || !servico || !data || !hora){
alert("Preencha todos os campos");
return;
}

const id = data + "_" + hora;

db.ref("agendamentos/" + id).once("value", snap => {

if(snap.exists()){
alert("Horário já ocupado");
return;
}

db.ref("agendamentos/" + id).set({
nome,
servico,
data,
hora
});

const numero = "5516997369740";
const msg = `Agendamento - ${nome}%0A${servico}%0A${data} às ${hora}`;

window.open(`https://wa.me/${numero}?text=${msg}`);

alert("Agendado com sucesso!");
});
}
</script>

</body>
</html>
